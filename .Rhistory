load(here::here("R Data","DBdata[asmt][v4.64].Rdata"))
anchovy<-timeseries_values_views |> filter(stockid=="PANCHPERUNC")
library(tidyverse)
anchovy<-timeseries_values_views |> filter(stockid=="PANCHPERUNC")
anchovy<-timeseries_values_views |>
filter(stockid=="PANCHPERUNC") |>
drop_na(TBbest)
load("enso_pdo.rda")
View(enso)
enso_avg<-enso |>
group_by(year) |>
summarise(avg=mean(enso))
View(enso_avg)
View(anchovy)
anchovy<-timeseries_values_views |>
filter(stockid=="PANCHPERUNC") |>
drop_na(TBbest) |>
select(year,TBbest,TCbest,stockid)
View(anchovy)
anchovy_enso<-left_join(anchovy,enso_avg,by="year")
enso_avg<-enso |>
group_by(year) |>
summarise(avg=mean(enso)) |>
mutate(year=as.numeric(year))
anchovy_enso<-left_join(anchovy,enso_avg,by="year")
View(anchovy_enso)
anchovy_enso |>
ggplot(aes(x=avg,y=TBbest))+
geom_point()+
geom_smooth(method="lm")+
labs(title="Anchovy and ENSO",x="ENSO",y="Biomass")+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg),color="red",shape=4)+
theme_minimal()
cor(anchovy_enso$TBbest,anchovy_enso$avg)
cor(anchovy_enso$TBbest,anchovy_enso$avg,use="complete.obs")
cor(anchovy_enso$TCbest,anchovy_enso$avg,use="complete.obs")
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg*.000000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg/.000000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg/.00000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg/.0000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg/.000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
anchovy_enso |>
ggplot(aes(x=year,y=TBbest))+
geom_point()+
geom_point(aes(x=year,y=avg/.0000001),color="red",shape=4)+
scale_y_continuous(sec.axis = sec_axis(~.*.000000001,name="ENSO"))+
theme_minimal()
enso_avg<-enso |>
group_by(year) |>
summarise(enso_avg=mean(enso)) |>
mutate(year=as.numeric(year))
anchovy_enso<-left_join(anchovy,enso_avg,by="year")
head(anchovy_enso) |>
knitr::kable()
anchovy_enso |>
drop_na(enso_avg) |>
head(anchovy_enso) |>
knitr::kable()
enso_avg<-enso |>
group_by(year) |>
summarise(enso_avg=mean(enso)) |>
mutate(year=as.numeric(year))
anchovy_enso |>
filter(year>=1981)|>
head(anchovy_enso) |>
knitr::kable()
cor(anchovy_enso$TBbest,anchovy_enso$enso_avg,use="complete.obs")
#| fig-cap: "Example of the discretizing the $z_t^\\omega$ distribution into 13 bins with a log normal distribution and mean 0 and standard deviation 0.5"
#| label: fig-omega
library(tidyverse)
#Environmental parameters
mean_omega=0
sigma_omega=0.5
#bin parameters
n_z=13
n_sims=100000
set.seed(42)
#Get distribution and bins of
omega_raw<-rlnorm(n_sims,mean=mean_omega,sd=sigma_omega)
omega_dist<-omega_raw[which(omega_raw<2.5)]
omegahist<-hist(omega_dist,breaks=seq(min(omega_dist),max(omega_dist),l=n_z+1))
#| fig-cap: "Example of the discretizing the $z_t^\\omega$ distribution into 13 bins with a log normal distribution and mean 0 and standard deviation 0.5"
#| label: fig-omega
library(tidyverse)
#Environmental parameters
mean_omega=0
sigma_omega=0.5
#bin parameters
n_z=13
n_sims=100000
set.seed(42)
#Get distribution and bins of
omega_raw<-rlnorm(n_sims,mean=mean_omega,sd=sigma_omega)
omega_dist<-omega_raw[which(omega_raw<2.5)]
omegahist<-hist(omega_dist,breaks=seq(min(omega_dist),max(omega_dist),l=n_z+1),main="Distribution of $z_t^\\omega$",xlab="$z_t^\\omega$",ylab="Frequency",col="lightblue",border="black"))
omegahist<-hist(omega_dist,breaks=seq(min(omega_dist),max(omega_dist),l=n_z+1),main="Distribution of $z_t^\\omega$",xlab="$z_t^\\omega$",ylab="Frequency",col="lightblue",border="black")
omegahist<-hist(omega_dist,breaks=seq(min(omega_dist),max(omega_dist),l=n_z+1),main=latex2exp::TeX(r'(Distribution of $z_t^\\omega$)'),xlab=latex2exp::TeX(r'($z_t^\omega)'),ylab="Frequency",col="lightblue",border="black")
omegahist<-hist(omega_dist,breaks=seq(min(omega_dist),max(omega_dist),l=n_z+1),main=latex2exp::TeX(r'(Distribution of $z_t^\omega$)'),xlab=latex2exp::TeX(r'($z_t^\omega)'),ylab="Frequency",col="lightblue",border="black")
sigma=0.25
mean(rlnorm(-0.5*sigma,sigma,1000)
)
?rlnorm
mean(rlnorm(n=1000,meanlog=-0.5*sigma,sdlog=sigma)
)
mean(rlnorm(n=1000,meanlog=-0.5*sigma^2,sdlog=sigma^2))
mean(rlnorm(n=10000,meanlog=-0.5*sigma^2,sdlog=sigma^2))
mean(rlnorm(n=10000,meanlog=0.5*sigma^2,sdlog=sigma^2))
sigma=500
mean(rlnorm(n=10000,meanlog=0.5*sigma^2,sdlog=sigma^2))
mean(rlnorm(n=10000,meanlog=-0.5*sigma^2,sdlog=sigma^2))
sigma=0.25
mean(rlnorm(n=10000,meanlog=0,sdlog=sigma^2))
mean(rlnorm(n=10000,meanlog=0,sdlog=sigma))
mean(rlnorm(n=10000,meanlog=-0.5*sigma,sdlog=sigma))
mean(rlnorm(n=10000,meanlog=-0.5*sigma^2,sdlog=sigma))
